<source>
  @type forward
  port 24224
  bind 0.0.0.0
</source>

<match **>
  @type s3
  aws_key_id "#{ENV['AWS_ACCESS_KEY_ID']}"
  aws_sec_key "#{ENV['AWS_SECRET_ACCESS_KEY']}"
  s3_bucket "#{ENV['S3_BUCKET_NAME']}"
  s3_region "#{ENV['S3_REGION']}"
  path logs/
  buffer_path /fluentd/buffer/s3
  time_slice_format %Y%m%d%H%M
  time_slice_wait 1m
  utc
  store_as json
  <format>
    @type json
  </format>
  <buffer>
    @type file
    path /fluentd/buffer/s3
    timekey 1m
    timekey_wait 10s
    timekey_use_utc true
  </buffer>
</match>
